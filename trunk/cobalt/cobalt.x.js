// XCobalt must be included only once.if(typeof window.XCobalt == 'undefined') {/*	YaweOS's XCobalt Client		< http://www.yawe.org/ >		< http://www.yawe.org/cobalt/x > 	Copyright 2007 - The YaweOS's Development Team 	    < http://www.yawe.org/contact >	YaweOS is released under the	GNU General Public License (GPL) version 3	provided with this release in license.txt	or via web at gnu.org/licenses/gpl.txt*/// Start: CobaltExtender (CobEx) - Can be used for extending any objectif(typeof window.cobex == 'undefined')    window.cobex = function(object, newobject){if(typeof object!='object'||typeof newobject!='object')return false;for(var key in newobject){if(window.cobexAddExtender)newobject[key]=window.cobexAddExtender(newobject[key]);object[key]=newobject[key];}return true;}if(typeof window.cobexAddExtender == 'undefined')    window.cobexAddExtender = function(object){if(typeof object!='object')return object;if(typeof object.extend!='function')object.extend=function(extend){return window.cobex(this, extend);};for(var key in object){if(typeof object[key]=='object')object[key]=window.cobexAddExtender(object[key]);}return object;}// End: CobaltExtender (CobEx)  //*****************************// // Start: XCobalt Basic Object ////*****************************//var XCobalt = {	version: '0.1',	isIE: (navigator.appName == 'Microsoft Internet Explorer'),		extend: function(extend)	{	    return window.cobex(this, extend);	}}  //***************************// // End: XCobalt Basic Object ////***************************//  //*********************// // Start: XWindow Core ////*********************//  // // XWindow Object//function XCobaltWindow(mainDiv, id) {	this.id    		= id;	this.width 		= 300;	this.height		= 230;	this.top   		= 30;	this.left  		= 30;	this.sticky		= false;		this.components = {		__container	: mainDiv,		__window	: false,				title		: false,		contents	: false,		status		: false	};	this.__focus	= 0;		this.__drawed	= false;}  // // XWindow Object Prototype//XCobaltWindow.prototype = {	// Draw a window on the workspace	draw: function()	{		var winDiv = this.components.__window;		    if(!this.components.__window)	    {	        winDiv = document.createElement('div');	        winDiv.style.position = 'absolute';	        winDiv.xwindowId = this.id;		}	    if(!this.__drawed)	    {	        if(this.components.__container.appendChild)		       	this.components.__container.appendChild(this.div);			else			    return false;            this.__drawed = true;		}	    winDiv.style.width = (this.width*1)+'px';	    winDiv.style.height = (this.height*1)+'px';	    winDiv.style.top = (this.top*1)+'px';	    winDiv.style.left = (this.left*1)+'px';	    return true;	},	// Destroy (hide) the window	destroy: function()	{	    this.components.__container.removeChild(this.div);	    this.__drawed = false;	    return true;	},	// Move the window	move: function(left, top)	{	    this.left = left*1;	    this.top = top*1;	    this.components.__window.style.left = this.left+'px';	    this.components.__window.style.top = this.top+'px';	    return true;	},	// Move the window relatively	relativeMove: function(left, top)	{	    this.left = this.left+(left*1);	    this.top = this.top+(top*1);	    this.components.__window.style.left = this.left+'px';	    this.components.__window.style.top = this.top+'px';	    	    return true;	},	// Resize the window	resize: function(width, height)	{	    this.width = width*1;	    this.height = height*1;	    this.components.__window.style.width = this.width+'px';	    this.components.__window.style.height = this.height+'px';	    return true;	},	// Resize the window relatively	relativeResize: function(width, height)	{	    this.width = this.width+(width*1);	    this.height = this.height+(height*1);	    	    if(this.width < 1)	        this.width = 1;        if(this.height < 1)	        this.height = 1;	    this.components.__window.style.width = this.width+'px';	    this.components.__window.style.height = this.height+'px';	    return true;	},	// Put the window over others	focus: function()	{	    if(this.sticky)	    {	        this.components.__window.style.zIndex = XCobalt.xcore.__windowGetStickNewFocus();	    }	    else	    {		   	this.components.__window.style.zIndex = XCobalt.xcore.__windowGetNewFocus();		   	this.__focus = this.div.style.zIndex;		}	    return true;	},	// StickOver the window --> always on top	stickover: function()	{	    this.sticky = true;	    return this.focus();	},    // StickDown the window --> reset to the normal focus level	stickdown: function()	{	    this.sticky = false;	    this.components.__window.style.zIndex = this.__focus;	    return true;	},		// Function called when a window control button is used	control: function(control)	{	    switch(control)		{		    case 'fullscreen':				if(this.sticky)			        return this.stickdown();				else				    return this.stickover();				break;							case 'reduce':			    break;			                case 'close':                this.destroy();			    break;			    			default:			    return false;		}				return true;	}}  // // Extends XCobalt//XCobalt.extend({xcore:{	// Return a xwindow object    windowsList: new Array,    window: function(id)	{	    if(this.windowsList[id])	    	return this.windowsList[id];		else		    return false;	},	// Create a new window	windowOpenCallback: false,	windowOpen: function(mainDiv)	{	    var newWindowId = this.windowsList.length;		this.windowsList.push(new XCobaltWindow(mainDiv, newWindowId));		var xwindow = this.window(newWindowId);		xwindow.draw();		xwindow.focus();				XCobalt.xlook.init(xwindow);			if(typeof this.windowOpenCallback == 'function')		    this.windowOpenCallback(xwindow);		    		return xwindow;	},		// Return a new focus level, for stickdowned window	windowHighestFocus: 0,	__windowGetNewFocus: function()	{	    this.windowHighestFocus++;	    return this.windowHighestFocus;	},		// Return a new focus level, for stickovered window	windowHighestStickFocus: 1000000000,	__windowGetStickNewFocus: function()	{	    this.windowHighestStickFocus++;	    return this.windowHighestStickFocus;	}}});  //*******************// // End: XWindow Core ////*******************//  //*************************// // Start: XWindow Interface ////*************************//XCobalt.extend({xlook:{	init: function(xwindow)	{	    xwindow.components.__window.innerHTML = '<table class="xcobalt-windowLayout"><tr class="xcobalt-windowLayout-top"><td class="xcobalt-windowLayout-top-left xcobalt-windowLayout-left"></td><td class="xcobalt-windowLayout-top-center xcobalt-windowLayout-center"><div class="xcobalt-windowLayout-top-center-div"><span class="xcobalt-windowLayout-top-center-floatLeft"></span><span class="xcobalt-windowLayout-top-center-floatRight"></span><span class="xcobalt-windowLayout-top-center-title"></span></div></td><td class="xcobalt-windowLayout-top-right xcobalt-windowLayout-right"></td></tr><tr class="xcobalt-windowLayout-middle"><td class="xcobalt-windowLayout-middle-left xcobalt-windowLayout-left"></td><td class="xcobalt-windowLayout-middle-center xcobalt-windowLayout-center"></td><td class="xcobalt-windowLayout-middle-right xcobalt-windowLayout-right"></td></tr><tr class="xcobalt-windowLayout-bottom"><td class="xcobalt-windowLayout-bottom-left xcobalt-windowLayout-left"></td><td class="xcobalt-windowLayout-bottom-center xcobalt-windowLayout-center"></td><td class="xcobalt-windowLayout-bottom-right xcobalt-windowLayout-right"></td></tr></table>';	    xwindow.components.__window.onclick = function() { XCobalt.xcore.window(this.xwindowId).focus(); };	    	    // Setup somes shortcuts for somes places of the table	    xwindow.components.title = xwindow.components.__window.getElementsByTagName('td')[1].getElementsByTagName('span')[2];	    xwindow.components.contents = xwindow.components.__window.getElementsByTagName('td')[4];	    xwindow.components.status = xwindow.components.__window.getElementsByTagName('td')[7];	    	    // Title	    xwindow.components.title.innerHTML = 'No title';	    	    // Drag 'n Drop	    xwindow.title.xwindowId = xwindow.id;	    xwindow.title.onmousedown = function(event) {            XCobalt.xcore.window(this.xwindowId).focus();	    	        if(XCobalt.isIE)	        {		        XCobalt.xlook.dragXstart = window.event.clientX;		        XCobalt.xlook.dragYstart = window.event.clientY;			}			else			{			    XCobalt.xlook.dragXstart = event.clientX;		        XCobalt.xlook.dragYstart = event.clientY;			}	        	        document.body.XCobaltCurentDragId = this.xwindowId;	        	        document.body.onmousemove = function(event) {	            if(XCobalt.isIE)	            	XCobalt.xcore.window(this.XCobaltCurentDragId).relativeMove(window.event.clientX-XCobalt.xlook.dragXstart, window.event.clientY-XCobalt.xlook.dragYstart);				else				    XCobalt.xcore.window(this.XCobaltCurentDragId).relativeMove(event.clientX-XCobalt.xlook.dragXstart, event.clientY-XCobalt.xlook.dragYstart);				if(XCobalt.isIE)		        {			        XCobalt.xlook.dragXstart = window.event.clientX;			        XCobalt.xlook.dragYstart = window.event.clientY;				}				else				{				    XCobalt.xlook.dragXstart = event.clientX;			        XCobalt.xlook.dragYstart = event.clientY;				}			}	        	        document.body.onmouseup = function(event) {	            if(XCobalt.isIE)		        {					document.body.onmousemove = null;					document.body.onmouseup = null;					document.body.XCobaltCurentDragId = null;				}				else				{				    delete document.body.onmousemove;					delete document.body.onmouseup;					delete document.body.XCobaltCurentDragId;				}			}		    		    return false;	    };	    	    // Resize	    xwindow.div.getElementsByTagName('td')[8].xwindowId = xwindow.id;	    xwindow.div.getElementsByTagName('td')[8].onmousedown = function(event) {            XCobalt.xcore.window(this.xwindowId).focus();	        if(XCobalt.isIE)	        {		        XCobalt.xlook.dragXstart = window.event.clientX;		        XCobalt.xlook.dragYstart = window.event.clientY;			}			else			{			    XCobalt.xlook.dragXstart = event.clientX;		        XCobalt.xlook.dragYstart = event.clientY;			}	        document.body.XCobaltCurentDragId = this.xwindowId;	        document.body.onmousemove = function(event) {	            if(XCobalt.isIE)	            	XCobalt.xcore.window(this.XCobaltCurentDragId).relativeResize(window.event.clientX-XCobalt.xlook.dragXstart, window.event.clientY-XCobalt.xlook.dragYstart);				else				    XCobalt.xcore.window(this.XCobaltCurentDragId).relativeResize(event.clientX-XCobalt.xlook.dragXstart, event.clientY-XCobalt.xlook.dragYstart);				if(XCobalt.isIE)		        {			        XCobalt.xlook.dragXstart = window.event.clientX;			        XCobalt.xlook.dragYstart = window.event.clientY;				}				else				{				    XCobalt.xlook.dragXstart = event.clientX;			        XCobalt.xlook.dragYstart = event.clientY;				}			}	        document.body.onmouseup = function(event) {	            if(XCobalt.isIE)		        {					document.body.onmousemove = null;					document.body.onmouseup = null;					document.body.XCobaltCurentDragId = null;				}				else				{				    delete document.body.onmousemove;					delete document.body.onmouseup;					delete document.body.XCobaltCurentDragId;				}			}		    return false;	    };	    	    xwindow.div.getElementsByTagName('td')[1].getElementsByTagName('span')[1].innerHTML = '<a href="#" onclick="XCobalt.xcore.window('+xwindow.id+').control(\'reduce\');return false;">–</a> <a href="#" onclick="XCobalt.xcore.window('+xwindow.id+').control(\'fullscreen\');return false;">#</a> <a href="#" onclick="XCobalt.xcore.window('+xwindow.id+').control(\'close\');return false;">X</a>';	}}});  //***********************// // End: XWindow Inteface ////***********************//}